<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>实验阅读材料（DFT-GEN 改写）</title>
  <style>
    :root{
      --bg:#ffffff;
      --card:#ffffff;
      --text:#111827;
      --muted:#4b5563;
      --accent:#2563eb;
      --border:#e5e7eb;
      --hl: rgba(250, 204, 21, .35);
      --hl-border: rgba(250, 204, 21, .60);
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:'Atkinson Hyperlegible','Lexend','Noto Sans SC','Source Han Sans SC','Microsoft YaHei UI','Microsoft YaHei','PingFang SC',system-ui,-apple-system,'Segoe UI',Arial,sans-serif;}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:980px;margin:0 auto;padding:28px 18px 60px}
    .hero{background:linear-gradient(135deg, rgba(37,99,235,.06), rgba(255,255,255,.0));border:1px solid var(--border);border-radius:16px;padding:18px 18px 12px}
    .hero h1{font-size:22px;margin:0 0 8px}
    .hero .sub{color:var(--muted);font-size:14px;line-height:1.5}
    .toolbar{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    .btn{display:inline-flex;align-items:center;gap:8px;background:rgba(37,99,235,.08);border:1px solid rgba(37,99,235,.22);color:var(--text);padding:8px 10px;border-radius:10px;font-size:13px}
    .btn.secondary{background:transparent;border:1px solid var(--border);color:var(--muted)}
    .toc{margin:18px 0 0;padding:0;list-style:none;display:grid;grid-template-columns:1fr;gap:10px}
    .toc li{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px}
    .toc .name{font-weight:650}
    .toc .meta{color:var(--muted);font-size:13px;margin-top:6px}
    section.item{margin-top:16px;background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px}
    .item h2{font-size:18px;margin:0 0 8px}
    .item .meta{color:var(--muted);font-size:13px;margin:0 0 10px;display:flex;gap:10px;flex-wrap:wrap}
    .hint{color:var(--muted);font-size:13px;margin:0 0 12px;line-height:1.6}
    mark.hl{background:var(--hl);border:1px solid var(--hl-border);padding:0 3px;border-radius:6px;color:var(--text)}

    /* Flash card */
    .slide-container{border:1px solid var(--border);border-radius:16px;background:rgba(37,99,235,.03);padding:14px}
    .slide{display:none}
    .slide.active{display:block}
    .slide-text{font-size:22px;line-height:2.05;letter-spacing:.2px;max-width:44rem}
    .controls{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-top:10px}
    .btn-nav{background:rgba(37,99,235,.08);border:1px solid rgba(37,99,235,.22);color:var(--text);padding:8px 12px;border-radius:12px;font-size:14px;cursor:pointer}
    .btn-nav:disabled{opacity:.35;cursor:not-allowed}
    .page-indicator{color:var(--muted);font-size:13px}

    /* Full view: split lines */
    .full-toggle{margin-top:12px}
    .full-btn{background:transparent;border:1px solid var(--border);color:var(--muted);padding:8px 10px;border-radius:12px;font-size:13px;cursor:pointer}
    .full-content{display:none;margin-top:10px}
    .full-lines{display:flex;flex-direction:column;gap:10px}
    .full-line{margin:0;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:rgba(37,99,235,.03);max-width:44rem;font-size:20px;line-height:2.0}

    .divider{height:1px;background:var(--border);margin:14px 0}
    .foot{color:var(--muted);font-size:12px;margin-top:16px}
    .top{position:fixed;right:16px;bottom:16px}
    </style>
</head>
<body>
  <div class="wrap">
    <div class="hero" id="top">
      <h1>实验阅读材料（DFT-GEN 改写）</h1>
      <div class="sub">请阅读目录中的 5 条介绍，并在问卷中回答对应信息理解题。</div>
      <div class="toolbar">
        <a class="btn" id="backLink" href="#">返回问卷</a>
        <a class="btn secondary" href="#top">回到目录</a>
      </div>
      <ul class="toc">
        <li>
              <div class="name"><a href="#s1-洮河石雕兰亭集会图砚">洮河石雕兰亭集会图砚</a></div>
              <div class="meta">类别：文房用品 · 编号：S1</div>
            </li><li>
              <div class="name"><a href="#s2-秦石鼓">秦石鼓</a></div>
              <div class="meta">类别：铭刻 · 编号：S2</div>
            </li><li>
              <div class="name"><a href="#s3-白玻璃单耳桃式杯">白玻璃单耳桃式杯</a></div>
              <div class="meta">类别：玻璃器 · 编号：S3</div>
            </li><li>
              <div class="name"><a href="#s4-木筒望远镜">木筒望远镜</a></div>
              <div class="meta">类别：钟表仪器 · 编号：S4</div>
            </li><li>
              <div class="name"><a href="#s5-小风扇">小风扇</a></div>
              <div class="meta">类别：外国文物 · 编号：S5</div>
            </li>
      </ul>
      <div class="foot">提示：本页为 DFT-GEN 条件阅读材料。默认 Focus Mode（翻页），可切换全文版（分行）。</div>
    </div>
    <section class="item" id="s1-洮河石雕兰亭集会图砚">
              <h2>洮河石雕兰亭集会图砚</h2>
              <div class="meta">
                <span>类别：文房用品</span>
                <span>编号：S1</span>
                <span><a href="https://www.dpm.org.cn/collection/studie/233225.html" target="_blank" rel="noopener">来源链接</a></span>
              </div>
              <div class="divider"></div>
              <div class="hint">默认显示 Focus Mode（可翻页的 flash card）。你也可以点击“查看全文版（分行）”。关键术语已高光。</div>
              <div class="slide-container" id="card-1">
                <div class="slides"></div>
                <div class="controls">
                  <button class="btn-nav btn-prev" onclick="prevSlide(1)">←</button>
                  <span class="page-indicator">1 / 1</span>
                  <button class="btn-nav btn-next" onclick="nextSlide(1)">→</button>
                </div>
                <div class="full-toggle">
                  <button class="full-btn" onclick="toggleFull(1)">查看全文版（分行）</button>
                  <div id="full-1" class="full-content"></div>
                </div>
              </div>
            </section><section class="item" id="s2-秦石鼓">
              <h2>秦石鼓</h2>
              <div class="meta">
                <span>类别：铭刻</span>
                <span>编号：S2</span>
                <span><a href="https://www.dpm.org.cn/collection/impres/234438.html" target="_blank" rel="noopener">来源链接</a></span>
              </div>
              <div class="divider"></div>
              <div class="hint">默认显示 Focus Mode（可翻页的 flash card）。你也可以点击“查看全文版（分行）”。关键术语已高光。</div>
              <div class="slide-container" id="card-2">
                <div class="slides"></div>
                <div class="controls">
                  <button class="btn-nav btn-prev" onclick="prevSlide(2)">←</button>
                  <span class="page-indicator">1 / 1</span>
                  <button class="btn-nav btn-next" onclick="nextSlide(2)">→</button>
                </div>
                <div class="full-toggle">
                  <button class="full-btn" onclick="toggleFull(2)">查看全文版（分行）</button>
                  <div id="full-2" class="full-content"></div>
                </div>
              </div>
            </section><section class="item" id="s3-白玻璃单耳桃式杯">
              <h2>白玻璃单耳桃式杯</h2>
              <div class="meta">
                <span>类别：玻璃器</span>
                <span>编号：S3</span>
                <span><a href="https://www.dpm.org.cn/collection/glass/229873.html" target="_blank" rel="noopener">来源链接</a></span>
              </div>
              <div class="divider"></div>
              <div class="hint">默认显示 Focus Mode（可翻页的 flash card）。你也可以点击“查看全文版（分行）”。关键术语已高光。</div>
              <div class="slide-container" id="card-3">
                <div class="slides"></div>
                <div class="controls">
                  <button class="btn-nav btn-prev" onclick="prevSlide(3)">←</button>
                  <span class="page-indicator">1 / 1</span>
                  <button class="btn-nav btn-next" onclick="nextSlide(3)">→</button>
                </div>
                <div class="full-toggle">
                  <button class="full-btn" onclick="toggleFull(3)">查看全文版（分行）</button>
                  <div id="full-3" class="full-content"></div>
                </div>
              </div>
            </section><section class="item" id="s4-木筒望远镜">
              <h2>木筒望远镜</h2>
              <div class="meta">
                <span>类别：钟表仪器</span>
                <span>编号：S4</span>
                <span><a href="https://www.dpm.org.cn/collection/clock/259986.html" target="_blank" rel="noopener">来源链接</a></span>
              </div>
              <div class="divider"></div>
              <div class="hint">默认显示 Focus Mode（可翻页的 flash card）。你也可以点击“查看全文版（分行）”。关键术语已高光。</div>
              <div class="slide-container" id="card-4">
                <div class="slides"></div>
                <div class="controls">
                  <button class="btn-nav btn-prev" onclick="prevSlide(4)">←</button>
                  <span class="page-indicator">1 / 1</span>
                  <button class="btn-nav btn-next" onclick="nextSlide(4)">→</button>
                </div>
                <div class="full-toggle">
                  <button class="full-btn" onclick="toggleFull(4)">查看全文版（分行）</button>
                  <div id="full-4" class="full-content"></div>
                </div>
              </div>
            </section><section class="item" id="s5-小风扇">
              <h2>小风扇</h2>
              <div class="meta">
                <span>类别：外国文物</span>
                <span>编号：S5</span>
                <span><a href="https://www.dpm.org.cn/collection/foreign/232146.html" target="_blank" rel="noopener">来源链接</a></span>
              </div>
              <div class="divider"></div>
              <div class="hint">默认显示 Focus Mode（可翻页的 flash card）。你也可以点击“查看全文版（分行）”。关键术语已高光。</div>
              <div class="slide-container" id="card-5">
                <div class="slides"></div>
                <div class="controls">
                  <button class="btn-nav btn-prev" onclick="prevSlide(5)">←</button>
                  <span class="page-indicator">1 / 1</span>
                  <button class="btn-nav btn-next" onclick="nextSlide(5)">→</button>
                </div>
                <div class="full-toggle">
                  <button class="full-btn" onclick="toggleFull(5)">查看全文版（分行）</button>
                  <div id="full-5" class="full-content"></div>
                </div>
              </div>
            </section>
  </div>
  <a class="btn top" href="#top">回到目录</a>
  <script>
    const slideData = {"1": ["这是一方宋代的洮河石砚。", "长22.4厘米，宽13.5厘米，", "厚6.8厘米。", "砚面和四个侧面都刻了兰亭修禊的场景。", "画的是王羲之和朋友们在兰亭聚会。", "砚边还刻了四十多个人和六只鹅。", "石色偏豆绿，质地细腻。", "洮砚是四大名砚之一，产自甘肃卓尼洮河一带。", "宋代开始盛行，也曾作为贡品进献朝廷。"], "2": ["石鼓共有十块。", "它们是花岗岩做的，每块高约90厘米，", "直径约60厘米。", "文字刻在鼓形石头上，所以叫石鼓文。", "内容是十首游猎诗。", "很多研究认为它是秦国的遗物。", "唐代韦应物、韩愈写《石鼓歌》称赞它。", "石鼓曾从陕西凤翔迁到开封，后来又到北京。", "多次搬迁让一些字磨损、残缺。"], "3": ["这是清代的白玻璃杯。", "高3厘米。", "杯身像桃子，柄像折枝。", "通体刻桃叶纹。", "白玻璃颜色像羊脂玉。", "用桃子做杯身，寓意长寿。"], "4": ["这是清代的木筒望远镜。", "全长34.7厘米，直径3.8厘米。", "它是单筒折射式，两端分别是目镜和物镜。", "镜头用铜鎏金包镶，镜片是凸透镜。", "它可用于观景、观测，也可用于作战指挥。"], "5": ["这是清宫旧藏的小风扇。", "长26.5厘米，宽12厘米，厚4厘米。", "它是玩具式的小风扇，手柄和扇页连在一起。", "手柄是化学制品，扇页是玳瑁材质。", "扇页背面写着“英格兰制造”。", "用手捏动手柄，扇页就会转动。"]};
    const fullData = {"1": ["这是一方宋代的洮河石砚。", "长22.4厘米，宽13.5厘米，厚6.8厘米。", "砚面和四个侧面都刻了兰亭修禊的场景。", "画的是王羲之和朋友们在兰亭聚会。", "砚边还刻了四十多个人和六只鹅。", "石色偏豆绿，质地细腻。", "洮砚是四大名砚之一，产自甘肃卓尼洮河一带。", "宋代开始盛行，也曾作为贡品进献朝廷。"], "2": ["石鼓共有十块。", "它们是花岗岩做的，每块高约90厘米，直径约60厘米。", "文字刻在鼓形石头上，所以叫石鼓文。", "内容是十首游猎诗。", "很多研究认为它是秦国的遗物。", "唐代韦应物、韩愈写《石鼓歌》称赞它。", "石鼓曾从陕西凤翔迁到开封，后来又到北京。", "多次搬迁让一些字磨损、残缺。"], "3": ["这是清代的白玻璃杯。", "高3厘米。", "杯身像桃子，柄像折枝。", "通体刻桃叶纹。", "白玻璃颜色像羊脂玉。", "用桃子做杯身，寓意长寿。"], "4": ["这是清代的木筒望远镜。", "全长34.7厘米，直径3.8厘米。", "它是单筒折射式，两端分别是目镜和物镜。", "镜头用铜鎏金包镶，镜片是凸透镜。", "它可用于观景、观测，也可用于作战指挥。"], "5": ["这是清宫旧藏的小风扇。", "长26.5厘米，宽12厘米，厚4厘米。", "它是玩具式的小风扇，手柄和扇页连在一起。", "手柄是化学制品，扇页是玳瑁材质。", "扇页背面写着“英格兰制造”。", "用手捏动手柄，扇页就会转动。"]};
    const highlightTerms = {"1": ["柳公权", "《论砚》", "赵希鹄", "《洞天清禄集", "西夏", "辉绿岩", "端砚", "歙砚", "临洮"], "2": ["康有为", "孙克弘", "韦应物", "韩愈", "《石鼓歌》", "燕京", "《集古录》"], "3": ["桃式", "桃叶纹", "羊脂", "白玉", "长寿"], "4": ["望远镜", "目镜", "物镜", "铜鎏金", "凸透镜", "天文观测", "作战指挥"], "5": ["玳瑁", "英格兰制造", "玩具", "手柄"]};

    function escapeHtml(s) {
      return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');
    }

    function escReg(s) {
      return s.replace(/[.*+?^{}()|[\]\\]/g, '\\$&');
    }

    function autoHighlight(html) {
      // highlight book titles 《...》 and years / numbers with units
      html = html.replace(/(《[^》]{1,24}》)/g, '<mark class="hl">$1</mark>');
      html = html.replace(/(\b\d{3,4}\b)/g, '<mark class="hl">$1</mark>');
      html = html.replace(/(\d+(?:\.\d+)?\s*(?:厘米|年|块|首|人|只|卷|字))/g, '<mark class="hl">$1</mark>');
      return html;
    }

    function applyHighlight(text, id) {
      let html = escapeHtml(text);
      const terms = (highlightTerms[String(id)] || []).slice().sort((a,b)=>b.length-a.length);
      for(const t of terms) {
        if(!t) continue;
        const re = new RegExp(escReg(t), 'g');
        html = html.replace(re, '<mark class="hl">' + escapeHtml(t) + '</mark>');
      }
      html = autoHighlight(html);
      return html.replace(/\n/g, '<br>');
    }

    function renderSlides(id) {
      const container = document.querySelector('#card-' + id + ' .slides');
      const slides = slideData[String(id)] || [];
      let html = '';
      slides.forEach((t, idx) => {
        const active = idx === 0 ? 'active' : '';
        html += '<div class="slide ' + active + '"><div class="slide-text">' + applyHighlight(t, id) + '</div></div>';
      });
      if(!slides.length) {
        html = `<div class="slide active"><div class="slide-text">(No content)</div></div>`;
      }
      container.innerHTML = html;
      updateControls(id, 0, Math.max(1, slides.length));
    }

    function renderFull(id) {
      const el = document.getElementById('full-' + id);
      const lines = fullData[String(id)] || [];
      const html = '<div class="full-lines">' + lines.map(l => '<p class="full-line">' + applyHighlight(l, id) + '</p>').join('') + '</div>';
      el.innerHTML = html;
    }

    function updateControls(id, idx, total) {
      const card = document.getElementById('card-' + id);
      card.querySelector('.btn-prev').disabled = idx === 0;
      card.querySelector('.btn-next').disabled = idx === total - 1;
      card.querySelector('.page-indicator').innerText = (idx + 1) + ' / ' + total;
    }

    function navigate(id, dir) {
      const container = document.querySelector('#card-' + id + ' .slides');
      const slides = container.querySelectorAll('.slide');
      let currIdx = 0;
      slides.forEach((s, i) => { if(s.classList.contains('active')) currIdx = i; });
      const total = slides.length || 1;
      const newIdx = currIdx + dir;
      if (newIdx >= 0 && newIdx < total) {
        slides[currIdx].classList.remove('active');
        slides[newIdx].classList.add('active');
        updateControls(id, newIdx, total);
      }
    }

    function nextSlide(id) { navigate(id, 1); }
    function prevSlide(id) { navigate(id, -1); }

    function toggleFull(id) {
      const el = document.getElementById('full-' + id);
      if(el.style.display === 'block') {
        el.style.display = 'none';
      } else {
        if(!el.innerHTML) renderFull(id);
        el.style.display = 'block';
      }
    }

    // allow survey to pass ?back=<url>
    (function(){
      try {
        const p = new URLSearchParams(location.search);
        const back = p.get('back');
        if(back) {
          const a = document.getElementById('backLink');
          a.href = back;
        }
      } catch(e) {}
    })();

    window.onload = function() {
      Object.keys(slideData).forEach((id) => {
        renderSlides(parseInt(id));
      });
    };
  </script>
</body>
</html>
